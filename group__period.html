<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Timescales Library: Periodogram generation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Timescales Library
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Simple API for calculating periodograms and related functions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__period.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Periodogram generation</div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for Lomb-Scargle Periodograms.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab8be76cd9fdab632c1f11406c04bb230"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230">kpftimes::lombScargle</a> (const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;times, const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;data, const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;freqs, <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;power)</td></tr>
<tr class="memdesc:gab8be76cd9fdab632c1f11406c04bb230"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Lomb-Scargle periodogram for a time series.  <a href="#gab8be76cd9fdab632c1f11406c04bb230">More...</a><br/></td></tr>
<tr class="separator:gab8be76cd9fdab632c1f11406c04bb230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad90dd13895292a75683de7740f0a6424"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__period.html#gad90dd13895292a75683de7740f0a6424">kpftimes::lsThreshold</a> (const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;times, const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;freqs, double fap, long nSims)</td></tr>
<tr class="memdesc:gad90dd13895292a75683de7740f0a6424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the significance threshold for a Lomb-Scargle periodogram.  <a href="#gad90dd13895292a75683de7740f0a6424">More...</a><br/></td></tr>
<tr class="separator:gad90dd13895292a75683de7740f0a6424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab3a488d98ed28a6723689f09b5d984fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__period.html#gab3a488d98ed28a6723689f09b5d984fb">kpftimes::lsNormalEdf</a> (const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;times, const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;freqs, <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;powers, <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;probs, long nSims)</td></tr>
<tr class="memdesc:gab3a488d98ed28a6723689f09b5d984fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the empirical distribution function of false peaks for a Lomb-Scargle periodogram.  <a href="#gab3a488d98ed28a6723689f09b5d984fb">More...</a><br/></td></tr>
<tr class="separator:gab3a488d98ed28a6723689f09b5d984fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for Lomb-Scargle Periodograms. </p>
<p>Implements periodograms following <a class="el" href="citelist.html#CITEREF_LSPeriodogram">[2]</a>. The implementation is based on the IDL function scargle.pro, maintained by Joern Wilms et al. as part of the IDL Astronomy Users Library. The Astronomy Users Library, available at <a href="http://idlastro.gsfc.nasa.gov/,">http://idlastro.gsfc.nasa.gov/,</a> is released under a BSD-2 license. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gab8be76cd9fdab632c1f11406c04bb230"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kpftimes::lombScargle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>freqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the Lomb-Scargle periodogram for a time series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">times</td><td>Times at which <code>data</code> were taken </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Measurements of a time series </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freqs</td><td>The frequency grid over which the periodogram should be calculated. See <a class="el" href="group__grid.html#ga591c0083b481ff4bbae69be4f33318ef" title="Creates a frequency grid that can be fed to time series analysis functions. ">freqGen()</a> for a quick way to generate a grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">power</td><td>The periodogram power at each frequency.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>times</code> contains at least two unique values </dd>
<dd>
<code>times</code> is sorted in ascending order </dd>
<dd>
<code>data.size()</code> = <code>times.size()</code> </dd>
<dd>
<code>data</code> has at least two unique values </dd>
<dd>
<code>data</code>[i] is the measurement of the source at <code>times</code>[i], for all i </dd>
<dd>
all elements of <code>freqs</code> are &ge; 0</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>power.size()</code> = <code>freqs.size()</code> </dd>
<dd>
<code>power</code>[i] is the Lomb-Scargle periodogram evaluated at <code>freqs</code>[i], for all i</dd></dl>
<dl class="section user"><dt>Performance</dt><dd>O(NF) time, where N = <code>times.size()</code> and F = <code>freqs.size()</code> </dd></dl>
<dl class="section user"><dt></dt><dd>O(N + F) memory</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classkpftimes_1_1except_1_1_bad_light_curve.html" title="This exception is thrown if a data set does not represent a variable time series. ...">kpftimes::except::BadLightCurve</a></td><td>Thrown if <code>times</code> or <code>data</code> has at most one distinct value. </td></tr>
    <tr><td class="paramname">kpfutils::except::NotSorted</td><td>Thrown if <code>times</code> is not in ascending order. </td></tr>
    <tr><td class="paramname"><a class="el" href="classkpftimes_1_1except_1_1_negative_freq.html" title="This exception is thrown if an analysis is run on negative frequencies. ">kpftimes::except::NegativeFreq</a></td><td>Thrown if some elements of <code>freqs</code> are negative. </td></tr>
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if <code>times</code> and <code>data</code> have different lengths. </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>Thrown if there is not enough memory to do the calculations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Exception Guarantee</dt><dd>The function arguments are unchanged in the event of an exception</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd><p class="startdd">Factor this function </p>
<p>Find a faster algorithm </p>
<p>Optimize for multiple calls with similar (but not identical) values of <code>times</code> and <code>freqs</code>, as would happen in a large survey where some epochs of some stars are removed for technical reasons. </p>
<p class="enddd">Verify that input validation is worth the cost </p>
</dd></dl>

</div>
</div>
<a class="anchor" id="gab3a488d98ed28a6723689f09b5d984fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kpftimes::lsNormalEdf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>freqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>powers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nSims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the empirical distribution function of false peaks for a Lomb-Scargle periodogram. </p>
<p>This function is a generalization of <a class="el" href="group__period.html#gad90dd13895292a75683de7740f0a6424" title="Calculates the significance threshold for a Lomb-Scargle periodogram. ">lsThreshold()</a>.</p>
<p>The intended use is that <a class="el" href="group__period.html#gab3a488d98ed28a6723689f09b5d984fb" title="Calculates the empirical distribution function of false peaks for a Lomb-Scargle periodogram. ">lsNormalEdf()</a> will accompany a call, or multiple calls, to <a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230" title="Calculates the Lomb-Scargle periodogram for a time series. ">lombScargle()</a> with the same values of <code>times</code> and <code>freqs</code>. Although <a class="el" href="group__period.html#gab3a488d98ed28a6723689f09b5d984fb" title="Calculates the empirical distribution function of false peaks for a Lomb-Scargle periodogram. ">lsNormalEdf()</a> is optimized for multiple calculations to a degree that <a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230" title="Calculates the Lomb-Scargle periodogram for a time series. ">lombScargle()</a> cannot, it will still run roughly <code>nSims/10</code> times longer than <a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230" title="Calculates the Lomb-Scargle periodogram for a time series. ">lombScargle()</a> itself. Don't run it after every real periodogram!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">times</td><td>Times at which data were taken </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freqs</td><td>The frequency grid over which the periodogram was calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">powers</td><td>The power levels at which the EDF is measured </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">probs</td><td>The probability that a periodogram calculated from white noise has a peak less than or equal to a power level </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nSims</td><td>Number of Gaussian white noise simulations to find the EDF.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>times</code> contains at least two unique values </dd>
<dd>
<code>times</code> is sorted in ascending order </dd>
<dd>
all elements of <code>freqs</code> are &ge; 0 </dd>
<dd>
<code>nSims</code> &ge; 1</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>powers.size()</code> == <code>probs.size()</code> == <code>nSims</code> </dd>
<dd>
<code>powers</code> is sorted in ascending order </dd>
<dd>
<code>probs</code> is sorted in ascending order</dd>
<dd>
<code>powers</code> and <code>probs</code> represent an empirical distribution function, such that probs[i] = EDF(powers[i]). The EDF is that of the peak power level observed in the periodograms of observations of an uncorrelated Gaussian noise source, if the uncorrelated source is sampled at the cadence represented by <code>times</code> and the periodogram is measured at frequencies <code>freqs</code>.</dd></dl>
<dl class="section user"><dt>Performance</dt><dd>O(NF × <code>nSims</code>) time, where N = <code>times.size()</code> and F = <code>freqs.size()</code> </dd></dl>
<dl class="section user"><dt></dt><dd>O(NF) memory</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classkpftimes_1_1except_1_1_bad_light_curve.html" title="This exception is thrown if a data set does not represent a variable time series. ...">kpftimes::except::BadLightCurve</a></td><td>Thrown if <code>times</code> has at most one distinct value. </td></tr>
    <tr><td class="paramname">kpfutils::except::NotSorted</td><td>Thrown if <code>times</code> is not in ascending order. </td></tr>
    <tr><td class="paramname"><a class="el" href="classkpftimes_1_1except_1_1_negative_freq.html" title="This exception is thrown if an analysis is run on negative frequencies. ">kpftimes::except::NegativeFreq</a></td><td>Thrown if some elements of <code>freqs</code> are negative. </td></tr>
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if <code>nSims</code> is nonpositive </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>Thrown if there is not enough memory to do the calculations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Exception Guarantee</dt><dd>The function arguments are unchanged in the event of an exception</dd></dl>
<dl class="test"><dt><b><a class="el" href="test.html#_test000001">Test:</a></b></dt><dd><p class="startdd">A 1-element time series and nSims = 100. Expected behavior = throw invalid_argument </p>
<p>A 2-element time series, sorted with no duplicates, and nSims = 100. Expected behavior = matches result of running lombScargle 100 times. </p>
<p>A 2-element time series, sorted with duplicates, and nSims = 100. Expected behavior = throw invalid_argument </p>
<p>A 2-element time series, unsorted, and nSims = 100. Expected behavior = throw invalid_argument. </p>
<p>A 100-element nonuniformly sampled time series, sorted with no duplicates, and negative frequencies. Expected behavior = throw domain_error. </p>
<p>A 100-element nonuniformly sampled time series, sorted with no duplicates, and multiple zero frequencies. Expected behavior = matches result of running lombScargle 100 times. </p>
<p>A 100-element uniformly sampled time series, sorted with no duplicates, and nSims = 100. Expected behavior = matches result of running lombScargle 100 times. </p>
<p>A 100-element nonuniformly sampled time series, sorted with no duplicates, and nSims = 100. Expected behavior = matches result of running lombScargle 100 times. </p>
<p>A 100-element nonuniformly sampled time series, sorted with no duplicates, and nSims = 0. Expected behavior = throw domain_error. </p>
<p>A 100-element nonuniformly sampled time series, sorted with no duplicates, and nSims = 1. Expected behavior = (probs = 1.0, powers = undefined) </p>
<p>A 100-element nonuniformly sampled time series, sorted with duplicates, and nSims = 100. Expected behavior = matches result of running lombScargle 100 times. </p>
<p class="enddd">A 100-element nonuniformly sampled time series, unsorted. Expected behavior = throw invalid_argument.</p>
</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>Factor this function </dd></dl>

</div>
</div>
<a class="anchor" id="gad90dd13895292a75683de7740f0a6424"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kpftimes::lsThreshold </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="timescales_8h.html#a0c7cd7d877b5ba249ee140c61f73ba69">DoubleVec</a> &amp;&#160;</td>
          <td class="paramname"><em>freqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nSims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the significance threshold for a Lomb-Scargle periodogram. </p>
<p>The intended use is that <a class="el" href="group__period.html#gad90dd13895292a75683de7740f0a6424" title="Calculates the significance threshold for a Lomb-Scargle periodogram. ">lsThreshold()</a> will accompany a call, or multiple calls, to <a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230" title="Calculates the Lomb-Scargle periodogram for a time series. ">lombScargle()</a> with the same values of <code>times</code> and <code>freqs</code>. Although <a class="el" href="group__period.html#gad90dd13895292a75683de7740f0a6424" title="Calculates the significance threshold for a Lomb-Scargle periodogram. ">lsThreshold()</a> is optimized for multiple calculations to a degree that <a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230" title="Calculates the Lomb-Scargle periodogram for a time series. ">lombScargle()</a> cannot, it will still run roughly nSims/10 times longer than <a class="el" href="group__period.html#gab8be76cd9fdab632c1f11406c04bb230" title="Calculates the Lomb-Scargle periodogram for a time series. ">lombScargle()</a> itself. Don't run it after every real periodogram!</p>
<p>The significance threshold is a strong function of the observing cadence (<code>times</code>), and a weaker function of the frequency grid (<code>freqs</code>). The latter dependence arises because in finer grids a (random or observed) periodogram peak is more likely to be sampled close to its maximum value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">times</td><td>Times at which data were taken </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freqs</td><td>The frequency grid over which the periodogram was calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fap</td><td>Desired false alarm probability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nSims</td><td>Number of Gaussian white noise simulations to find the FAP power level.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The peak power level that will be reached, with probability <code>fap</code>, in a periodogram of Gaussian white noise.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>times</code> contains at least two unique values </dd>
<dd>
<code>times</code> is sorted in ascending order </dd>
<dd>
all elements of <code>freqs</code> are &ge; 0 </dd>
<dd>
0 &lt; <code>fap</code> &lt; 1 </dd>
<dd>
<code>nSims</code> &ge; 1 </dd>
<dd>
<code>fap</code> × <code>nSims</code> &gt;&gt; 1</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The function returns the peak power level observed in the periodograms of (1-<code>fap</code>) of observations of an uncorrelated Gaussian noise source, if the uncorrelated source is sampled at the cadence represented by <code>times</code> and the periodogram is measured at frequencies <code>freqs</code>.</dd></dl>
<dl class="section user"><dt>Performance</dt><dd>O(NF × <code>nSims</code>) time, where N = <code>times.size()</code> and F = <code>freqs.size()</code> </dd></dl>
<dl class="section user"><dt></dt><dd>O(NF) memory</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classkpftimes_1_1except_1_1_bad_light_curve.html" title="This exception is thrown if a data set does not represent a variable time series. ...">kpftimes::except::BadLightCurve</a></td><td>Thrown if <code>times</code> has at most one distinct value. </td></tr>
    <tr><td class="paramname">kpfutils::except::NotSorted</td><td>Thrown if <code>times</code> is not in ascending order. </td></tr>
    <tr><td class="paramname"><a class="el" href="classkpftimes_1_1except_1_1_negative_freq.html" title="This exception is thrown if an analysis is run on negative frequencies. ">kpftimes::except::NegativeFreq</a></td><td>Thrown if some elements of <code>freqs</code> are negative. </td></tr>
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if <code>fap</code> is outside (0, 1) or if <code>nSims</code> is nonpositive </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>Thrown if there is not enough memory to do the calculations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Exception Guarantee</dt><dd>The function arguments are unchanged in the event of an exception</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd><p class="startdd">Factor this function </p>
<p>Test the performance advantage AFTER refactoring </p>
<p class="enddd">Verify that input validation is worth the cost </p>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Aug 18 2014 19:24:34 for Timescales Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
