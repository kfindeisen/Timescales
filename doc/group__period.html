<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Timescales Library: Periodogram generation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Timescales Library&#160;<span id="projectnumber">0.2</span></div>
   <div id="projectbrief">Simple API for calculating periodograms and related functions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Periodogram generation</div>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__period.html#gae1f03252f094cf8180186c55a9fa635d">SCARGLE_SLOW</a>&#160;&#160;&#160;0</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A compiler flag controlling the strategy used for <a class="el" href="group__period.html#gacdd9f96f83722b7ef582431b75c9a336" title="Calculates the significance threshold for a Lomb-Scargle periodogram.">lsThreshold()</a>.  <a href="#gae1f03252f094cf8180186c55a9fa635d"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__period.html#ga2c64d467f67fa7f90f96617275e057a7">kpftimes::lombScargle</a> (const DoubleVec &amp;times, const DoubleVec &amp;fluxes, const DoubleVec &amp;freq, DoubleVec &amp;power)  throw (std::invalid_argument, std::domain_error)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Lomb-Scargle periodogram for a time series.  <a href="#ga2c64d467f67fa7f90f96617275e057a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__period.html#gacdd9f96f83722b7ef582431b75c9a336">kpftimes::lsThreshold</a> (const DoubleVec &amp;times, const DoubleVec &amp;freq, double fap, int nSims)  throw (std::invalid_argument, std::domain_error)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the significance threshold for a Lomb-Scargle periodogram.  <a href="#gacdd9f96f83722b7ef582431b75c9a336"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gae1f03252f094cf8180186c55a9fa635d"></a><!-- doxytag: member="scargle.cpp::SCARGLE_SLOW" ref="gae1f03252f094cf8180186c55a9fa635d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCARGLE_SLOW&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A compiler flag controlling the strategy used for <a class="el" href="group__period.html#gacdd9f96f83722b7ef582431b75c9a336" title="Calculates the significance threshold for a Lomb-Scargle periodogram.">lsThreshold()</a>. </p>
<p>If set to 0 or not set [the default], <a class="el" href="group__period.html#gacdd9f96f83722b7ef582431b75c9a336" title="Calculates the significance threshold for a Lomb-Scargle periodogram.">lsThreshold()</a> is optimized for speed at the expense of memory. If set to 1, it is instead optimized for memory use at the expense of speed. The default setting should perform better on all but the oldest systems.</p>
<p>This flag is best set in the call to the compiler, rather than in the code itself. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga2c64d467f67fa7f90f96617275e057a7"></a><!-- doxytag: member="kpftimes::lombScargle" ref="ga2c64d467f67fa7f90f96617275e057a7" args="(const DoubleVec &amp;times, const DoubleVec &amp;fluxes, const DoubleVec &amp;freq, DoubleVec &amp;power)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kpftimes::lombScargle </td>
          <td>(</td>
          <td class="paramtype">const DoubleVec &amp;&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DoubleVec &amp;&#160;</td>
          <td class="paramname"><em>fluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DoubleVec &amp;&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DoubleVec &amp;&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throw (std::invalid_argument, std::domain_error)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the Lomb-Scargle periodogram for a time series. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">times</td><td>Times at which data were taken </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fluxes</td><td>Flux measurements of a source </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freq</td><td>The frequency grid over which the periodogram should be calculated. See <a class="el" href="group__grid.html#ga591c0083b481ff4bbae69be4f33318ef" title="Creates a frequency grid that can be fed to time series analysis functions.">freqGen()</a> for a quick way to generate a grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">power</td><td>The periodogram power at each frequency.</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>times contains at least two unique values </dd>
<dd>
times is sorted in ascending order </dd>
<dd>
fluxes is of the same length as times </dd>
<dd>
fluxes has at least two unique values </dd>
<dd>
fluxes[i] is the flux of the source at times[i], for all i </dd>
<dd>
all elements of freq are &gt;= 0 </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>power is of the same length as freq </dd>
<dd>
power[i] is the Lomb-Scargle periodogram evaluated at freq[i], for all i </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">domain_error</td><td>Thrown if negative frequencies are provided </td></tr>
    <tr><td class="paramname">invalid_argument</td><td>Thrown if any of the preconditions on the format of times or fluxes are violated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Optimize for multiple calls with similar [but not identical] values of times and freq, as would happen in a large survey where some epochs of some stars are removed for technical reasons. </dd></dl>

</div>
</div>
<a class="anchor" id="gacdd9f96f83722b7ef582431b75c9a336"></a><!-- doxytag: member="kpftimes::lsThreshold" ref="gacdd9f96f83722b7ef582431b75c9a336" args="(const DoubleVec &amp;times, const DoubleVec &amp;freq, double fap, int nSims)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kpftimes::lsThreshold </td>
          <td>(</td>
          <td class="paramtype">const DoubleVec &amp;&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DoubleVec &amp;&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nSims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throw (std::invalid_argument, std::domain_error)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the significance threshold for a Lomb-Scargle periodogram. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">times</td><td>Times at which data were taken </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freq</td><td>The frequency grid over which the periodogram was calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fap</td><td>Desired false alarm probability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nSims</td><td>Number of white noise simulations to find the FAP power level.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The peak power level that will be reached, with probability fap, in a periodogram of white noise.</dd></dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>times contains at least two unique values </dd>
<dd>
times is sorted in ascending order </dd>
<dd>
all elements of freq are &gt;= 0 </dd>
<dd>
0 &lt; fap &lt; 1 </dd>
<dd>
nSims &gt;= 1 </dd>
<dd>
fap*nSims &gt;&gt; 1 </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>The function returns the peak power level observed in the periodograms of (1-fap) of observations of an uncorrelated Gaussian noise source, if the uncorrelated source is sampled at the cadence represented by times and the periodogram is measured at frequencies freq. </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">domain_error</td><td>Thrown if negative frequencies, fap, or nSims are provided. </td></tr>
    <tr><td class="paramname">invalid_argument</td><td>Thrown if any of the preconditions on the format of times or the values of fap and nSims are violated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The intended use is that lsThreshold() will accompany a call, or multiple calls, to <a class="el" href="group__period.html#ga2c64d467f67fa7f90f96617275e057a7" title="Calculates the Lomb-Scargle periodogram for a time series.">lombScargle()</a> with the same values of times and freq. Although lsThreshold() is optimized for multiple calculations to a degree that lombScargle() cannot, it will still run roughly nSims/10 times longer than lombScargle() itself. Don't run it after every real periodogram!</dd>
<dd>
The significance threshold is a strong function of the observing cadence (times), and a weaker function of the frequency grid (freq). The latter dependence arises because in finer grids a (random or observed) periodogram peak is more likely to be sampled close to its maximum value.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Test the performance advantage AFTER refactoring </dd></dl>

</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 15 2011 17:10:21 for Timescales Library by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
